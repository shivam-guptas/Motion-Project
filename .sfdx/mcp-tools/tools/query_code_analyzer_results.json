{
  "name": "query_code_analyzer_results",
  "description": "Query a Code Analyzer results JSON file and return filtered violations.\nSupports filters like severity, category/tag, engine, rule, and file name, plus top-N and sorting.\nUse this after running \"run_code_analyzer\" to read the generated results file.\nAfter completion, this tool will summarize and explain the filtered results to the user.\n\nPolicy: To avoid overwhelming results, this tool returns no more than the top 10 violations by default.\nRequesting more than 10 requires an explicit opt-in via allowLargeResultSet=true and is not recommended.\nNote: Querying larger result sets can significantly increase token consumption.\n\nExamples (natural language → selector/topN):\n- \"Top 5 security in PMD\" → selector: \"Security:pmd\", topN: 5\n- \"Top 10 critical\" → selector: \"Critical\", topN: 10\n- \"Top 5 security or performance in ESLint\" → selector: \"(Security,Performance):eslint\", topN: 5\n- \"Top 5 PMD High severity\" → selector: \"pmd:High\", topN: 5\n- \"Top 5 for rule MyRuleName\" → selector: \"rule=MyRuleName\", topN: 5\n- \"Top 5 in files under src/app\" → selector: \"file=src/app\", topN: 5\n",
  "inputSchema": {
    "type": "object",
    "properties": {
      "resultsFile": {
        "type": "string",
        "description": "Absolute path to a results JSON file produced by the code analyzer., if results file is not provided, call run_code_analyzer tool to generate a results file first."
      },
      "selector": {
        "type": "string",
        "description": "Selector (same semantics as \"list_code_analyzer_rules\"): colon-separated tokens with optional OR-groups in parentheses, e.g., \"Security:(pmd,eslint):High\"."
      },
      "topN": {
        "type": "integer",
        "exclusiveMinimum": 0,
        "maximum": 1000,
        "default": 10,
        "description": "Return at most this many violations after filtering and sorting (default 10). Never increase this number unless the user explicitly asks for a larger result set. Requests >10 require allowLargeResultSet=true."
      },
      "allowLargeResultSet": {
        "type": "boolean",
        "description": "Explicit opt-in to request more than the top 10 violations. Defaults to false and is not recommended unless the user explicitly requests a larger result set. If set to true, you must also increase topN to the desired value."
      },
      "sortBy": {
        "type": "string",
        "enum": [
          "severity",
          "rule",
          "engine",
          "file",
          "none"
        ],
        "description": "Optional primary sort field."
      },
      "sortDirection": {
        "type": "string",
        "enum": [
          "asc",
          "desc"
        ],
        "description": "Optional sort direction."
      }
    },
    "required": [
      "resultsFile",
      "selector"
    ],
    "additionalProperties": false,
    "$schema": "http://json-schema.org/draft-07/schema#"
  }
}